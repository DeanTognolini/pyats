# =============================================================================
# pyATS Logging Configuration
# =============================================================================
#
# This file configures logging for pyATS test execution.
#
# Usage:
#   To use this configuration, you can either:
#   1. Export environment variable:
#      export PYATS_LOG_CONFIG=/path/to/logging_config.yaml
#   2. Pass it via command line:
#      pyats run job layer1_job.py --testbed testbed.yaml --log-config logging_config.yaml
#
# Log Levels:
#   CRITICAL - 50
#   ERROR    - 40
#   WARNING  - 30
#   INFO     - 20
#   DEBUG    - 10
#   NOTSET   - 0
#
# =============================================================================

version: 1
disable_existing_loggers: false

# Formatters define the output format for log messages
formatters:
  standard:
    format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
    datefmt: '%Y-%m-%d %H:%M:%S'

  detailed:
    format: '%(asctime)s - %(name)s - %(levelname)s - [%(filename)s:%(lineno)d] - %(message)s'
    datefmt: '%Y-%m-%d %H:%M:%S'

  simple:
    format: '%(levelname)s - %(message)s'

  pyats:
    format: '%(asctime)s: %(levelname)-8s: %(message)s'
    datefmt: '%Y-%m-%dT%H:%M:%S'

# Handlers define where log messages go (console, file, etc.)
handlers:
  console:
    class: logging.StreamHandler
    level: INFO
    formatter: pyats
    stream: ext://sys.stdout

  file:
    class: logging.handlers.RotatingFileHandler
    level: DEBUG
    formatter: detailed
    filename: logs/pyats.log
    maxBytes: 10485760  # 10MB
    backupCount: 5
    encoding: utf8

  error_file:
    class: logging.handlers.RotatingFileHandler
    level: ERROR
    formatter: detailed
    filename: logs/pyats_errors.log
    maxBytes: 10485760  # 10MB
    backupCount: 5
    encoding: utf8

# Loggers - configure specific modules
loggers:
  # pyATS core logging
  pyats:
    level: INFO
    handlers: [console, file]
    propagate: false

  # Unicon (connection library)
  unicon:
    level: WARNING
    handlers: [console, file]
    propagate: false

  # Genie (parser library)
  genie:
    level: INFO
    handlers: [console, file]
    propagate: false

  # Test script logging
  __main__:
    level: INFO
    handlers: [console, file, error_file]
    propagate: false

  # Your custom test modules
  layer1_tests:
    level: INFO
    handlers: [console, file, error_file]
    propagate: false

  layer1_job:
    level: INFO
    handlers: [console, file]
    propagate: false

# Root logger - catches everything not caught by specific loggers
root:
  level: INFO
  handlers: [console, file]

# =============================================================================
# Environment-Based Configuration Override
# =============================================================================
#
# You can override the log level using environment variables:
#
# export PYATS_LOG_LEVEL=DEBUG     # Set pyATS to DEBUG level
# export UNICON_LOG_LEVEL=DEBUG    # Set Unicon to DEBUG level
# export GENIE_LOG_LEVEL=INFO      # Set Genie to INFO level
#
# Example usage in code:
#
#   import logging
#   import os
#
#   logger = logging.getLogger(__name__)
#   log_level = os.environ.get('PYATS_LOG_LEVEL', 'INFO')
#   logger.setLevel(getattr(logging, log_level))
#
# =============================================================================
